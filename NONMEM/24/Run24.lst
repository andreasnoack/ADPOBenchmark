Thu 09/05/2024 
06:00 PM
$PROBLEM    Dual Numbers benchmark - NONMEM
$ABBR DERIV2=NO 
$INPUT       ID TIME AMT DV WT
$DATA      c:/git/adpoBenchmark/data/sim_0_5_1_0.csv IGNORE=@
  ;; data file name must match out file name in the template file for simulations in data folder
  ;;from data\template.txt
  ;; $TABLE ID TIME AMT IOBS EVID WT FILE=c:\git\dual_numbers\data\OUT_0_5_1_0.DAT NOPRINT NOHEADER NOAPPEND
  ;; and file read/write in make_data.r
  ;; file_name <- paste0(this_comp,"_",this_eta,"_",this_vwt,"_",this_gamma)
$SUBROUTINE ADVAN6 TOL=7
$MODEL
  COMP=(DEPOT,DEFDOSE)
  COMP=(CENTRAL,NODOSE,DEFOBS)

$PK      
  CWT = WT/70 

  TVVMAX= THETA(1)   
  VMAX=TVVMAX*EXP(ETA(1)) 
  TVKM = THETA(2)
  KM = TVKM *EXP(ETA(2))  
  TVV2=THETA(3) *CWT**THETA(5)
  V2=TVV2 *EXP(ETA(3))    
  TVKA=THETA(4) 
  KA=TVKA   

  SC = V2
$ERROR 
 IPRED = F   

  Y=F*EXP(EPS(2)) + EPS(1)
$DES
  CONC = A(2)/SC
  DADT(1) = -KA*A(1)
  DADT(2) =  KA*A(1)-VMAX*CONC/(KM+CONC) 


$THETA   
  (100,4000)	; THETA(1) VMAX UNITS =  mass/time
  (100,4000)	; THETA(2) KM UNITS = mass/volume
  (1,50) 		; THETA(3) V  UNITS = volume
  (0.01,1.2,3) 		; THETA(4) KA UNITS = 1/time    

  (0,1.1,10) 	;; THETA(5) V~WT

  ;; Start OMEGA
$OMEGA  BLOCK(3)
  0.1		; ETA(1) ETA ON VMAX
  0.05 0.1		; ETA(2) ETA ON KM
  0.05 0.05 0.1		; ETA(3) ETA ON V2
$SIGMA     
  (1) ;; EPS(1) ADDITIVE
  (0.3) ;; EPS(2) PROPORTIONAL
$EST METHOD=COND INTER MAXEVALS=9999 NOHABORT NOOMEGABOUNDTEST NOSIGMABOUNDTEST NOTHETABOUNDTEST
$COV UNCOND PRECOND=2
  ;;; Model Identifier =  0,5,1,0

;; Phenotype: ([('COMP', 0), ('ETAs', 5), ('V~WT', 1), ('GAMMA', 0)])
;; Genotype: [0, 5, 1, 0]
;; Num non-influential tokens: 0

$TABLE ID TIME IPRED DV NOAPPEND ONEHEADER NOPRINT FILE= Run1Preds.dat  
NM-TRAN MESSAGES 
  
 WARNINGS AND ERRORS (IF ANY) FOR PROBLEM    1
             
 (WARNING  2) NM-TRAN INFERS THAT THE DATA ARE POPULATION.
  
License Registered to: Certara USA
Expiration Date:    14 MAR 2025
Current Date:        5 SEP 2024
Days until program expires : 194
1NONLINEAR MIXED EFFECTS MODEL PROGRAM (NONMEM) VERSION 7.4.3
 ORIGINALLY DEVELOPED BY STUART BEAL, LEWIS SHEINER, AND ALISON BOECKMANN
 CURRENT DEVELOPERS ARE ROBERT BAUER, ICON DEVELOPMENT SOLUTIONS,
 AND ALISON BOECKMANN. IMPLEMENTATION, EFFICIENCY, AND STANDARDIZATION
 PERFORMED BY NOUS INFOSYSTEMS.

 PROBLEM NO.:         1
 Dual Numbers benchmark - NONMEM
0DATA CHECKOUT RUN:              NO
 DATA SET LOCATED ON UNIT NO.:    2
 THIS UNIT TO BE REWOUND:        NO
 NO. OF DATA RECS IN DATA SET:      480
 NO. OF DATA ITEMS IN DATA SET:   7
 ID DATA ITEM IS DATA ITEM NO.:   1
 DEP VARIABLE IS DATA ITEM NO.:   4
 MDV DATA ITEM IS DATA ITEM NO.:  7
0INDICES PASSED TO SUBROUTINE PRED:
   6   2   3   0   0   0   0   0   0   0   0
0LABELS FOR DATA ITEMS:
 ID TIME AMT DV WT EVID MDV
0(NONBLANK) LABELS FOR PRED-DEFINED ITEMS:
 IPRED
0FORMAT FOR DATA:
 (5E8.0,2F2.0)

 TOT. NO. OF OBS RECS:      420
 TOT. NO. OF INDIVIDUALS:       60
0LENGTH OF THETA:   5
0DEFAULT THETA BOUNDARY TEST OMITTED:   YES
0OMEGA HAS BLOCK FORM:
  1
  1  1
  1  1  1
0DEFAULT OMEGA BOUNDARY TEST OMITTED:   YES
0SIGMA HAS SIMPLE DIAGONAL FORM WITH DIMENSION:   2
0DEFAULT SIGMA BOUNDARY TEST OMITTED:   YES
0INITIAL ESTIMATE OF THETA:
 LOWER BOUND    INITIAL EST    UPPER BOUND
  0.1000E+03     0.4000E+04     0.1000E+07
  0.1000E+03     0.4000E+04     0.1000E+07
  0.1000E+01     0.5000E+02     0.1000E+07
  0.1000E-01     0.1200E+01     0.3000E+01
  0.0000E+00     0.1100E+01     0.1000E+02
0INITIAL ESTIMATE OF OMEGA:
 BLOCK SET NO.   BLOCK                                                                    FIXED
        1                                                                                   NO
                  0.1000E+00
                  0.5000E-01   0.1000E+00
                  0.5000E-01   0.5000E-01   0.1000E+00
0INITIAL ESTIMATE OF SIGMA:
 0.1000E+01
 0.0000E+00   0.3000E+00
0COVARIANCE STEP OMITTED:        NO
 EIGENVLS. PRINTED:              NO
 SPECIAL COMPUTATION:            NO
 COMPRESSED FORMAT:              NO
 GRADIENT METHOD USED:     NOSLOW
 SIGDIGITS ETAHAT (SIGLO):                  -1
 SIGDIGITS GRADIENTS (SIGL):                -1
 EXCLUDE COV FOR FOCE (NOFCOV):              NO
 TURN OFF Cholesky Transposition of R Matrix (CHOLROFF): NO
 KNUTHSUMOFF:                                -1
 RESUME COV ANALYSIS (RESUME):               NO
 SIR SAMPLE SIZE (SIRSAMPLE):              -1
 NON-LINEARLY TRANSFORM THETAS DURING COV (THBND): 1
 PRECONDTIONING CYCLES (PRECOND):        2
 PRECONDTIONING TYPES (PRECONDS):        TOS
 FORCED PRECONDTIONING CYCLES (PFCOND):0
 PRECONDTIONING TYPE (PRETYPE):        0
 FORCED POS. DEFINITE SETTING: (FPOSDEF):0
0TABLES STEP OMITTED:    NO
 NO. OF TABLES:           1
 SEED NUMBER (SEED):    11456
 RANMETHOD:             3U
 MC SAMPLES (ESAMPLE):    300
 WRES SQUARE ROOT TYPE (WRESCHOL): EIGENVALUE
0-- TABLE   1 --
0RECORDS ONLY:    ALL
04 COLUMNS APPENDED:    NO
 PRINTED:                NO
 HEADER:                YES
 FILE TO BE FORWARDED:   NO
 FORMAT:                S1PE11.4
 LFORMAT:
 RFORMAT:
 FIXED_EFFECT_ETAS:
0USER-CHOSEN ITEMS:
 ID TIME IPRED DV
1DOUBLE PRECISION PREDPP VERSION 7.4.3

 GENERAL NONLINEAR KINETICS MODEL (DVERK1, ADVAN6)
0MODEL SUBROUTINE USER-SUPPLIED - ID NO. 9999
0MAXIMUM NO. OF BASIC PK PARAMETERS:   4
0COMPARTMENT ATTRIBUTES
 COMPT. NO.   FUNCTION   INITIAL    ON/OFF      DOSE      DEFAULT    DEFAULT
                         STATUS     ALLOWED    ALLOWED    FOR DOSE   FOR OBS.
    1         DEPOT        ON         YES        YES        YES        NO
    2         CENTRAL      ON         YES        NO         NO         YES
    3         OUTPUT       OFF        YES        NO         NO         NO
 INITIAL (BASE) TOLERANCE SETTINGS:
 NRD (RELATIVE) VALUE OF TOLERANCE:   7
 ANRD (ABSOLUTE) VALUE OF TOLERANCE:  12
1
 ADDITIONAL PK PARAMETERS - ASSIGNMENT OF ROWS IN GG
 COMPT. NO.                             INDICES
              SCALE      BIOAVAIL.   ZERO-ORDER  ZERO-ORDER  ABSORB
                         FRACTION    RATE        DURATION    LAG
    1            *           *           *           *           *
    2            5           -           -           -           -
    3            *           -           -           -           -
             - PARAMETER IS NOT ALLOWED FOR THIS MODEL
             * PARAMETER IS NOT SUPPLIED BY PK SUBROUTINE;
               WILL DEFAULT TO ONE IF APPLICABLE
0DATA ITEM INDICES USED BY PRED ARE:
   EVENT ID DATA ITEM IS DATA ITEM NO.:      6
   TIME DATA ITEM IS DATA ITEM NO.:          2
   DOSE AMOUNT DATA ITEM IS DATA ITEM NO.:   3

0PK SUBROUTINE CALLED WITH EVERY EVENT RECORD.
 PK SUBROUTINE NOT CALLED AT NONEVENT (ADDITIONAL OR LAGGED) DOSE TIMES.
0ERROR SUBROUTINE CALLED WITH EVERY EVENT RECORD.
0DES SUBROUTINE USES COMPACT STORAGE MODE.
1


 #TBLN:      1
 #METH: First Order Conditional Estimation with Interaction

 ESTIMATION STEP OMITTED:                 NO
 ANALYSIS TYPE:                           POPULATION
 NUMBER OF SADDLE POINT RESET ITERATIONS:      0
 GRADIENT METHOD USED:               NOSLOW
 CONDITIONAL ESTIMATES USED:              YES
 CENTERED ETA:                            NO
 EPS-ETA INTERACTION:                     YES
 LAPLACIAN OBJ. FUNC.:                    NO
 NO. OF FUNCT. EVALS. ALLOWED:            9999
 NO. OF SIG. FIGURES REQUIRED:            3
 INTERMEDIATE PRINTOUT:                   YES
 ESTIMATE OUTPUT TO MSF:                  NO
 ABORT WITH PRED EXIT CODE 1:             NO
 IND. OBJ. FUNC. VALUES SORTED:           NO
 NUMERICAL DERIVATIVE
       FILE REQUEST (NUMDER):               NONE
 MAP (ETAHAT) ESTIMATION METHOD (OPTMAP):   0
 ETA HESSIAN EVALUATION METHOD (ETADER):    0
 INITIAL ETA FOR MAP ESTIMATION (MCETA):    0
 SIGDIGITS FOR MAP ESTIMATION (SIGLO):      100
 GRADIENT SIGDIGITS OF
       FIXED EFFECTS PARAMETERS (SIGL):     100
 NOPRIOR SETTING (NOPRIOR):                 OFF
 NOCOV SETTING (NOCOV):                     OFF
 DERCONT SETTING (DERCONT):                 OFF
 FINAL ETA RE-EVALUATION (FNLETA):          ON
 EXCLUDE NON-INFLUENTIAL (NON-INFL.) ETAS
       IN SHRINKAGE (ETASTYPE):             NO
 NON-INFL. ETA CORRECTION (NONINFETA):      OFF
 RAW OUTPUT FILE (FILE): Run24.ext
 EXCLUDE TITLE (NOTITLE):                   NO
 EXCLUDE COLUMN LABELS (NOLABEL):           NO
 FORMAT FOR ADDITIONAL FILES (FORMAT):      S1PE12.5
 PARAMETER ORDER FOR OUTPUTS (ORDER):       TSOL
 WISHART PRIOR DF INTERPRETATION (WISHTYPE):0
 KNUTHSUMOFF:                               0
 INCLUDE LNTWOPI:                           NO
 INCLUDE CONSTANT TERM TO PRIOR (PRIORC):   NO
 INCLUDE CONSTANT TERM TO OMEGA (ETA) (OLNTWOPI):NO
 ADDITIONAL CONVERGENCE TEST (CTYPE=4)?:    NO
 EM OR BAYESIAN METHOD USED:                 NONE

 TOLERANCES FOR ESTIMATION/EVALUATION STEP:
 NRD (RELATIVE) VALUE OF TOLERANCE:   7
 ANRD (ABSOLUTE) VALUE OF TOLERANCE:  12
 TOLERANCES FOR COVARIANCE STEP:
 NRD (RELATIVE) VALUE OF TOLERANCE:   7
 ANRD (ABSOLUTE) VALUE OF TOLERANCE:  12
 TOLERANCES FOR TABLE/SCATTER STEP:
 NRD (RELATIVE) VALUE OF TOLERANCE:   7
 ANRD (ABSOLUTE) VALUE OF TOLERANCE:  12

 THE FOLLOWING LABELS ARE EQUIVALENT
 PRED=PREDI
 RES=RESI
 WRES=WRESI
 IWRS=IWRESI
 IPRD=IPREDI
 IRS=IRESI

 MONITORING OF SEARCH:


0ITERATION NO.:    0    OBJECTIVE VALUE:   492790.426360288        NO. OF FUNC. EVALS.:   9
 CUMULATIVE NO. OF FUNC. EVALS.:        9
 NPARAMETR:  4.0000E+03  4.0000E+03  5.0000E+01  1.2000E+00  1.1000E+00  1.0000E-01  5.0000E-02  5.0000E-02  1.0000E-01  5.0000E-02
             1.0000E-01  1.0000E+00  3.0000E-01
 PARAMETER:  1.0000E-01  1.0000E-01  1.0000E-01  1.0000E-01  1.0000E-01  1.0000E-01  1.0000E-01  1.0000E-01  1.0000E-01  1.0000E-01
             1.0000E-01  1.0000E-01  1.0000E-01
 GRADIENT:   3.7757E+02 -5.4394E+02 -1.2188E+03  8.3526E+01  4.3517E+03  2.2139E+02 -1.2667E+03 -2.4785E+03 -4.6024E+02 -3.0474E+03
            -9.5325E+02 -9.6935E+05 -1.0192E+03

0ITERATION NO.:  115    OBJECTIVE VALUE:   5416.03424751573        NO. OF FUNC. EVALS.:2020
 CUMULATIVE NO. OF FUNC. EVALS.:     2029
 NPARAMETR:  1.4022E+06  6.5753E+05  3.5062E+01  6.8337E-01  9.0275E-03  3.5183E+00  2.6766E+00  6.2835E-01  2.0362E+00  4.7799E-01
             2.0241E-01  2.1595E+00  2.6729E-01
 PARAMETER:  5.9907E+00  5.2288E+00 -2.6380E-01 -7.2132E-01 -4.8184E+00  1.8790E+00  9.0273E-01  2.1189E-01 -7.8941E+00 -3.2901E-01
            -5.4010E+00  4.8503E-01  4.2338E-02
 GRADIENT:   8.4496E+00  4.8539E+00 -8.6550E+01  5.2558E+01 -1.1385E-02 -2.5165E+02  1.8332E+01  4.2939E+02  5.3795E+00 -3.9140E+02
            -4.5409E+01  2.2746E+01  2.3325E+01
 NUMSIGDIG:         2.8         3.3         3.0         3.0         5.2         2.9         3.3         3.7         4.7         3.8
                    3.7         3.5         2.9

 #TERM:
0MINIMIZATION TERMINATED
 DUE TO ROUNDING ERRORS (ERROR=134)
 NO. OF FUNCTION EVALUATIONS USED:     2029
 NO. OF SIG. DIGITS IN FINAL EST.:  2.8

 ETABAR IS THE ARITHMETIC MEAN OF THE ETA-ESTIMATES,
 AND THE P-VALUE IS GIVEN FOR THE NULL HYPOTHESIS THAT THE TRUE MEAN IS 0.

 ETABAR:        -2.3866E-01 -1.8184E-01 -5.9709E-02
 SE:             2.4116E-01  1.8376E-01  5.7289E-02
 N:                      60          60          60

 P VAL.:         3.2237E-01  3.2238E-01  2.9730E-01

 ETASHRINKSD(%)  1.0000E-10  1.0000E-10  5.4373E-01
 ETASHRINKVR(%)  1.0000E-10  1.0000E-10  1.0845E+00
 EBVSHRINKSD(%)  5.7234E+00  5.7231E+00  9.0208E+00
 EBVSHRINKVR(%)  1.1119E+01  1.1119E+01  1.7228E+01
 EPSSHRINKSD(%)  7.9796E+00  7.9796E+00
 EPSSHRINKVR(%)  1.5322E+01  1.5322E+01

  
 TOTAL DATA POINTS NORMALLY DISTRIBUTED (N):          420
 N*LOG(2PI) CONSTANT TO OBJECTIVE FUNCTION:    771.90836789192508     
 OBJECTIVE FUNCTION VALUE WITHOUT CONSTANT:    5416.0342475157258     
 OBJECTIVE FUNCTION VALUE WITH CONSTANT:       6187.9426154076509     
 REPORTED OBJECTIVE FUNCTION DOES NOT CONTAIN CONSTANT
  
 TOTAL EFFECTIVE ETAS (NIND*NETA):                           180
  
 #TERE:
 Elapsed estimation  time in seconds:   235.13
 TESTING R MATRIX FOR POSITIVE DEFINITNESS
 R MATRIX IS NOT POSITIVE DEFINITE
 PRECONDITIONING CYCLE NO.            1
 TESTING R MATRIX FOR POSITIVE DEFINITNESS
 R MATRIX IS NOT POSITIVE DEFINITE
 PRECONDITIONING CYCLE NO.            2
0R MATRIX ALGORITHMICALLY SINGULAR
 AND ALGORITHMICALLY NON-POSITIVE-SEMIDEFINITE
0R MATRIX IS OUTPUT
0S MATRIX UNOBTAINABLE
0COVARIANCE STEP ABORTED
 Elapsed covariance  time in seconds:   122.10
 Elapsed postprocess time in seconds:     0.25
1
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 ************************************************************************************************************************
 ********************                                                                                ********************
 ********************               FIRST ORDER CONDITIONAL ESTIMATION WITH INTERACTION              ********************
 #OBJT:**************                       MINIMUM VALUE OF OBJECTIVE FUNCTION                      ********************
 ********************                                                                                ********************
 ************************************************************************************************************************
 





 #OBJV:********************************************     5416.034       **************************************************
1
 ************************************************************************************************************************
 ********************                                                                                ********************
 ********************               FIRST ORDER CONDITIONAL ESTIMATION WITH INTERACTION              ********************
 ********************                             FINAL PARAMETER ESTIMATE                           ********************
 ********************                                                                                ********************
 ************************************************************************************************************************
 


 THETA - VECTOR OF FIXED EFFECTS PARAMETERS   *********


         TH 1      TH 2      TH 3      TH 4      TH 5     
 
         1.41E+06  6.58E+05  3.51E+01  6.84E-01  9.03E-03
 


 OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS  ********


         ETA1      ETA2      ETA3     
 
 ETA1
+        3.51E+00
 
 ETA2
+        2.67E+00  2.04E+00
 
 ETA3
+        6.28E-01  4.78E-01  2.02E-01
 


 SIGMA - COV MATRIX FOR RANDOM EFFECTS - EPSILONS  ****


         EPS1      EPS2     
 
 EPS1
+        2.16E+00
 
 EPS2
+        0.00E+00  2.67E-01
 
1


 OMEGA - CORR MATRIX FOR RANDOM EFFECTS - ETAS  *******


         ETA1      ETA2      ETA3     
 
 ETA1
+        1.87E+00
 
 ETA2
+        1.00E+00  1.43E+00
 
 ETA3
+        7.45E-01  7.45E-01  4.50E-01
 


 SIGMA - CORR MATRIX FOR RANDOM EFFECTS - EPSILONS  ***


         EPS1      EPS2     
 
 EPS1
+        1.47E+00
 
 EPS2
+        0.00E+00  5.17E-01
 
1
 ************************************************************************************************************************
 ********************                                                                                ********************
 ********************               FIRST ORDER CONDITIONAL ESTIMATION WITH INTERACTION              ********************
 ********************                                     R MATRIX                                   ********************
 ********************                                                                                ********************
 ************************************************************************************************************************
 

            TH 1      TH 2      TH 3      TH 4      TH 5      OM11      OM12      OM13      OM22      OM23      OM33      SG11  
             SG12      SG22  
 
 TH 1
+        9.32E-09
 
 TH 2
+       -2.19E-08  7.41E-08
 
 TH 3
+        4.39E-04  7.82E-05  1.35E+02
 
 TH 4
+        1.47E-01 -5.26E-01  2.11E+03  4.29E+06
 
 TH 5
+       -6.16E-01  3.24E+00 -8.13E+03 -3.07E+07  2.74E+08
 
 OM11
+       -1.16E+07 -4.60E+07 -5.33E+12  3.32E+14 -3.30E+15  1.89E+51
 
 OM12
+        3.05E+07  1.21E+08  1.40E+13 -8.73E+14  8.67E+15 -4.97E+51  1.30E+52
 
 OM13
+        9.37E+03  3.71E+04  4.30E+09 -2.68E+11  2.67E+12 -1.53E+48  4.01E+48  1.24E+45
 
 OM22
+        5.83E+07 -1.46E+08 -3.83E+12  2.06E+15 -1.18E+16  3.26E+51 -8.56E+51 -2.63E+48  5.62E+51
 
 OM23
+        3.59E+04 -8.97E+04 -2.36E+09  1.26E+12 -7.25E+12  2.01E+48 -5.27E+48 -1.62E+45  3.46E+48  2.13E+45
 
 OM33
+        4.68E+00  1.15E-01  6.40E+05  8.19E+06  3.95E+08  3.09E+44 -8.11E+44 -2.49E+41  5.32E+44  3.27E+41  5.03E+37
 
 SG11
+        4.23E-03 -8.05E-03  6.99E+02  1.08E+05 -9.11E+05 -4.80E+14  1.26E+15  3.88E+11 -8.26E+14 -5.10E+11 -7.84E+07  2.40E+07
 
 SG12
+       ......... ......... ......... ......... ......... ......... ......... ......... ......... ......... ......... .........
         .........
 
 SG22
+       -8.92E-02  1.57E-01 -2.58E+04 -3.33E+06  2.25E+07 -1.55E+17  4.06E+17  1.25E+14 -2.66E+17 -1.64E+14 -2.52E+10  1.40E+09
         .........  1.04E+11
 
 Elapsed finaloutput time in seconds:     0.03
 #CPUT: Total CPU Time in Seconds,      356.781
Stop Time: 
Thu 09/05/2024 
06:06 PM
